<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MrCheap Business Management System</title>
  <!-- Load React and Babel -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <!-- Load Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Load Lucide React Icons -->
  <script src="https://unpkg.com/lucide-react@latest"></script>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    // Create Lucide icons as React components
    const createLucideIcon = (iconName) => {
      return function Icon(props) {
        return React.createElement('svg', {
          ...props,
          width: props.size || '24',
          height: props.size || '24',
          viewBox: '0 0 24 24',
          fill: 'none',
          stroke: 'currentColor',
          strokeWidth: '2',
          strokeLinecap: 'round',
          strokeLinejoin: 'round'
        }, React.createElement(iconName));
      };
    };

    // Define Lucide icons we need
    const LucideIcons = {
      Package: createLucideIcon('rect'),
      ShoppingCart: createLucideIcon('shopping-cart'),
      DollarSign: createLucideIcon('dollar-sign'),
      TrendingUp: createLucideIcon('trending-up'),
      Users: createLucideIcon('users'),
      FileText: createLucideIcon('file-text'),
      Settings: createLucideIcon('settings'),
      Menu: createLucideIcon('menu'),
      X: createLucideIcon('x'),
      Plus: createLucideIcon('plus'),
      Edit: createLucideIcon('edit'),
      Trash2: createLucideIcon('trash-2'),
      Eye: createLucideIcon('eye'),
      EyeOff: createLucideIcon('eye-off')
    };

    // Use React and ReactDOM from global scope
    const { useState, useEffect } = React;
    
    // Extract icons
    const { 
      Package, ShoppingCart, DollarSign, TrendingUp, Users, 
      FileText, Settings, Menu, X, Plus, Edit, Trash2, Eye, EyeOff 
    } = LucideIcons;

    const MrCheapSystem = () => {
      const [currentPage, setCurrentPage] = useState('dashboard');
      const [language, setLanguage] = useState('english');
      const [sidebarOpen, setSidebarOpen] = useState(true);
      const [currentUser, setCurrentUser] = useState(null);

      // Data states - using in-memory storage with localStorage backup
      const [users, setUsers] = useState([
        {
          id: '1',
          username: 'admin',
          password: 'admin123',
          role: 'admin',
          name: 'Administrator',
          active: true
        }
      ]);

      const [products, setProducts] = useState([
        { id: '1', name: 'Electric Kettle', quantity: 25, buyPrice: 15000, sellPrice: 25000, category: 'Kitchen' },
        { id: '2', name: 'Multicooker', quantity: 15, buyPrice: 45000, sellPrice: 75000, category: 'Kitchen' },
        { id: '3', name: 'Pressure Cooker', quantity: 8, buyPrice: 35000, sellPrice: 55000, category: 'Kitchen' },
        { id: '4', name: 'Phone Charger', quantity: 50, buyPrice: 3000, sellPrice: 5000, category: 'Electronics' },
        { id: '5', name: 'Standing Fan', quantity: 12, buyPrice: 25000, sellPrice: 40000, category: 'Appliances' }
      ]);

      const [sales, setSales] = useState([]);
      const [purchases, setPurchases] = useState([]);
      const [expenses, setExpenses] = useState([]);

      // Load data from localStorage on mount
      useEffect(() => {
        const savedData = localStorage.getItem('mrcheap_data');
        if (savedData) {
          try {
            const data = JSON.parse(savedData);
            if (data.users) setUsers(data.users);
            if (data.products) setProducts(data.products);
            if (data.sales) setSales(data.sales);
            if (data.purchases) setPurchases(data.purchases);
            if (data.expenses) setExpenses(data.expenses);
          } catch (error) {
            console.error('Error loading data:', error);
          }
        }
      }, []);

      // Save data to localStorage whenever it changes
      useEffect(() => {
        const data = {
          users,
          products,
          sales,
          purchases,
          expenses
        };
        localStorage.setItem('mrcheap_data', JSON.stringify(data));
      }, [users, products, sales, purchases, expenses]);

      // Translation object
      const translations = {
        english: {
          dashboard: 'Dashboard',
          inventory: 'Inventory',
          purchases: 'Purchases',
          sales: 'Sales',
          expenses: 'Expenses',
          reports: 'Reports',
          users: 'User Management',
          settings: 'Settings',
          totalSales: 'Total Sales',
          totalPurchases: 'Total Purchases',
          currentStock: 'Current Stock Value',
          profit: 'Net Profit',
          lowStock: 'Low Stock Alerts',
          recentSales: 'Recent Sales',
          topProducts: 'Top Selling Products',
          logout: 'Logout',
          login: 'Login',
          username: 'Username',
          password: 'Password',
          businessName: 'MrCheap Electronics',
          currency: 'TZS'
        },
        swahili: {
          dashboard: 'Dashibodi',
          inventory: 'Hifadhi',
          purchases: 'Manunuzi',
          sales: 'Mauzo',
          expenses: 'Matumizi',
          reports: 'Ripoti',
          users: 'Usimamizi wa Watumiaji',
          settings: 'Mipangilio',
          totalSales: 'Jumla ya Mauzo',
          totalPurchases: 'Jumla ya Manunuzi',
          currentStock: 'Thamani ya Bidhaa',
          profit: 'Faida',
          lowStock: 'Bidhaa Zinazokwisha',
          recentSales: 'Mauzo ya Karibuni',
          topProducts: 'Bidhaa Zinazouzwa Zaidi',
          logout: 'Ondoka',
          login: 'Ingia',
          username: 'Jina la Mtumiaji',
          password: 'Neno la Siri',
          businessName: 'MrCheap Electronics',
          currency: 'TZS'
        }
      };

      const t = translations[language];

      // Login Component
      const LoginPage = () => {
        const [username, setUsername] = useState('');
        const [password, setPassword] = useState('');
        const [error, setError] = useState('');

        const handleLogin = () => {
          const user = users.find(u => u.username === username && u.password === password && u.active);
          
          if (user) {
            setCurrentUser(user);
            setError('');
          } else {
            setError(language === 'english' ? 'Invalid credentials or user disabled' : 'Jina au neno la siri si sahihi');
          }
        };

        return (
          React.createElement('div', { className: "min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4" },
            React.createElement('div', { className: "bg-white rounded-lg shadow-xl p-8 w-full max-w-md" },
              React.createElement('div', { className: "text-center mb-8" },
                React.createElement('h1', { className: "text-3xl font-bold text-indigo-600 mb-2" }, t.businessName),
                React.createElement('p', { className: "text-gray-600" }, t.login)
              ),
              
              error && React.createElement('div', { className: "bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4" }, error),

              React.createElement('div', { className: "space-y-4" },
                React.createElement('div', null,
                  React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2" }, t.username),
                  React.createElement('input', {
                    type: "text",
                    value: username,
                    onChange: (e) => setUsername(e.target.value),
                    className: "w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",
                    placeholder: language === 'english' ? 'Enter username' : 'Weka jina la mtumiaji'
                  })
                ),

                React.createElement('div', null,
                  React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2" }, t.password),
                  React.createElement('input', {
                    type: "password",
                    value: password,
                    onChange: (e) => setPassword(e.target.value),
                    onKeyPress: (e) => e.key === 'Enter' && handleLogin(),
                    className: "w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",
                    placeholder: language === 'english' ? 'Enter password' : 'Weka neno la siri'
                  })
                ),

                React.createElement('button', {
                  onClick: handleLogin,
                  className: "w-full bg-indigo-600 text-white py-2 rounded-lg hover:bg-indigo-700 transition-colors"
                }, t.login),

                React.createElement('div', { className: "text-center text-sm text-gray-600 mt-4" },
                  language === 'english' ? 'Default: admin / admin123' : 'Chaguo-msingi: admin / admin123'
                ),

                React.createElement('button', {
                  onClick: () => setLanguage(language === 'english' ? 'swahili' : 'english'),
                  className: "w-full mt-4 text-sm text-indigo-600 hover:text-indigo-800"
                }, language === 'english' ? 'Badilisha kwa Kiswahili' : 'Switch to English')
              )
            )
          )
        );
      };

      // Dashboard Component
      const Dashboard = () => {
        const formatCurrency = (amount) => {
          return `${t.currency} ${amount.toLocaleString()}`;
        };

        const totalSales = sales.reduce((sum, sale) => sum + (sale.total || 0), 0);
        const totalPurchases = purchases.reduce((sum, purchase) => sum + (purchase.total || 0), 0);
        const totalExpenses = expenses.reduce((sum, expense) => sum + (expense.amount || 0), 0);
        const stockValue = products.reduce((sum, product) => sum + (product.quantity * product.buyPrice), 0);
        const profit = totalSales - totalPurchases - totalExpenses;

        return (
          React.createElement('div', { className: "p-6" },
            React.createElement('h2', { className: "text-3xl font-bold text-gray-800 mb-6" }, t.dashboard),
            
            React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8" },
              React.createElement('div', { className: "bg-gradient-to-br from-green-400 to-green-600 rounded-lg shadow-lg p-6 text-white" },
                React.createElement('div', { className: "flex items-center justify-between" },
                  React.createElement('div', null,
                    React.createElement('p', { className: "text-green-100 text-sm" }, t.totalSales),
                    React.createElement('p', { className: "text-2xl font-bold mt-2" }, formatCurrency(totalSales))
                  ),
                  React.createElement(ShoppingCart, { className: "w-12 h-12 text-green-200" })
                )
              ),

              React.createElement('div', { className: "bg-gradient-to-br from-blue-400 to-blue-600 rounded-lg shadow-lg p-6 text-white" },
                React.createElement('div', { className: "flex items-center justify-between" },
                  React.createElement('div', null,
                    React.createElement('p', { className: "text-blue-100 text-sm" }, t.totalPurchases),
                    React.createElement('p', { className: "text-2xl font-bold mt-2" }, formatCurrency(totalPurchases))
                  ),
                  React.createElement(Package, { className: "w-12 h-12 text-blue-200" })
                )
              ),

              React.createElement('div', { className: "bg-gradient-to-br from-purple-400 to-purple-600 rounded-lg shadow-lg p-6 text-white" },
                React.createElement('div', { className: "flex items-center justify-between" },
                  React.createElement('div', null,
                    React.createElement('p', { className: "text-purple-100 text-sm" }, t.currentStock),
                    React.createElement('p', { className: "text-2xl font-bold mt-2" }, formatCurrency(stockValue))
                  ),
                  React.createElement(DollarSign, { className: "w-12 h-12 text-purple-200" })
                )
              ),

              React.createElement('div', { className: `bg-gradient-to-br ${profit >= 0 ? 'from-emerald-400 to-emerald-600' : 'from-red-400 to-red-600'} rounded-lg shadow-lg p-6 text-white` },
                React.createElement('div', { className: "flex items-center justify-between" },
                  React.createElement('div', null,
                    React.createElement('p', { className: "text-white text-sm" }, t.profit),
                    React.createElement('p', { className: "text-2xl font-bold mt-2" }, formatCurrency(profit))
                  ),
                  React.createElement(TrendingUp, { className: "w-12 h-12 text-white opacity-80" })
                )
              )
            ),

            React.createElement('div', { className: "bg-white rounded-lg shadow-lg p-6" },
              React.createElement('h3', { className: "text-xl font-bold text-gray-800 mb-4" }, language === 'english' ? 'Quick Actions' : 'Vitendo vya Haraka'),
              React.createElement('div', { className: "grid grid-cols-2 md:grid-cols-4 gap-4" },
                React.createElement('button', {
                  onClick: () => setCurrentPage('sales'),
                  className: "bg-green-500 text-white p-4 rounded-lg hover:bg-green-600 transition-colors"
                },
                  React.createElement(ShoppingCart, { className: "w-6 h-6 mx-auto mb-2" }),
                  React.createElement('span', { className: "text-sm" }, language === 'english' ? 'New Sale' : 'Uza')
                ),
                React.createElement('button', {
                  onClick: () => setCurrentPage('purchases'),
                  className: "bg-blue-500 text-white p-4 rounded-lg hover:bg-blue-600 transition-colors"
                },
                  React.createElement(Package, { className: "w-6 h-6 mx-auto mb-2" }),
                  React.createElement('span', { className: "text-sm" }, language === 'english' ? 'New Purchase' : 'Nunua')
                ),
                React.createElement('button', {
                  onClick: () => setCurrentPage('inventory'),
                  className: "bg-purple-500 text-white p-4 rounded-lg hover:bg-purple-600 transition-colors"
                },
                  React.createElement(Package, { className: "w-6 h-6 mx-auto mb-2" }),
                  React.createElement('span', { className: "text-sm" }, language === 'english' ? 'View Stock' : 'Tazama Bidhaa')
                ),
                React.createElement('button', {
                  onClick: () => setCurrentPage('reports'),
                  className: "bg-indigo-500 text-white p-4 rounded-lg hover:bg-indigo-600 transition-colors"
                },
                  React.createElement(FileText, { className: "w-6 h-6 mx-auto mb-2" }),
                  React.createElement('span', { className: "text-sm" }, language === 'english' ? 'Reports' : 'Ripoti')
                )
              )
            )
          )
        );
      };

      // Main App Layout
      if (!currentUser) {
        return React.createElement(LoginPage);
      }

      return (
        React.createElement('div', { className: "flex h-screen bg-gray-100" },
          // Sidebar
          React.createElement('div', { className: `${sidebarOpen ? 'w-64' : 'w-20'} bg-indigo-800 text-white transition-all duration-300 flex flex-col` },
            React.createElement('div', { className: "p-4 flex items-center justify-between" },
              sidebarOpen && React.createElement('h1', { className: "text-xl font-bold" }, t.businessName),
              React.createElement('button', { 
                onClick: () => setSidebarOpen(!sidebarOpen), 
                className: "text-white" 
              }, sidebarOpen ? React.createElement(X) : React.createElement(Menu))
            ),

            React.createElement('nav', { className: "flex-1 mt-4" },
              [
                { id: 'dashboard', icon: TrendingUp, label: t.dashboard },
                { id: 'inventory', icon: Package, label: t.inventory },
                { id: 'purchases', icon: ShoppingCart, label: t.purchases },
                { id: 'sales', icon: DollarSign, label: t.sales },
                { id: 'expenses', icon: FileText, label: t.expenses },
                { id: 'reports', icon: FileText, label: t.reports },
                { id: 'users', icon: Users, label: t.users },
                { id: 'settings', icon: Settings, label: t.settings }
              ].map((item) =>
                React.createElement('button', {
                  key: item.id,
                  onClick: () => setCurrentPage(item.id),
                  className: `w-full flex items-center px-4 py-3 hover:bg-indigo-700 transition-colors ${
                    currentPage === item.id ? 'bg-indigo-700 border-l-4 border-white' : ''
                  }`
                },
                  React.createElement(item.icon, { className: "w-5 h-5" }),
                  sidebarOpen && React.createElement('span', { className: "ml-3" }, item.label)
                )
              )
            ),

            React.createElement('div', { className: "p-4 border-t border-indigo-700" },
              React.createElement('button', {
                onClick: () => setCurrentUser(null),
                className: "w-full flex items-center px-4 py-2 hover:bg-indigo-700 rounded transition-colors"
              },
                React.createElement(Users, { className: "w-5 h-5" }),
                sidebarOpen && React.createElement('span', { className: "ml-3" }, t.logout)
              )
            )
          ),

          // Main Content
          React.createElement('div', { className: "flex-1 overflow-auto" },
            React.createElement('div', { className: "bg-white shadow-sm p-4 flex justify-between items-center" },
              React.createElement('h2', { className: "text-xl font-semibold text-gray-800" },
                language === 'english' ? `Welcome, ${currentUser.name}` : `Karibu, ${currentUser.name}`
              ),
              React.createElement('button', {
                onClick: () => setLanguage(language === 'english' ? 'swahili' : 'english'),
                className: "px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors text-sm"
              }, language === 'english' ? 'Kiswahili' : 'English')
            ),

            currentPage === 'dashboard' && React.createElement(Dashboard)
            // Note: Other components (inventory, purchases, sales, etc.) would be added here
          )
        )
      );
    };

    // Render the app
    ReactDOM.render(React.createElement(MrCheapSystem), document.getElementById('root'));
  </script>
</body>
</html>
